Component,Alarm Name,Metric Name,Statistic,Threshold,Period (seconds),Evaluation Periods,Datapoints to Alarm,Severity,Reasoning
NAT GW,ErrorPortAllocation,ErrorPortAllocation,Sum,>= 10 errors,60,5,5,P1-Critical,NAT Gateway cannot allocate source port for IP translation - means connections are being DROPPED. 55k connection limit per unique destination (IP:port:protocol combination). Threshold 10 provides early detection. All 5 periods (5 min) confirms sustained exhaustion. Production-validated by UK Gov Digital Service.
NAT GW,PacketsDropCount,PacketsDropCount,Sum,>= 100 packets,60,5,5,P1-Critical,"Packets dropped by NAT GW indicate connection table exhaustion, rate limiting, or congestion. Different from TGW drops (routing) - NAT drops indicate capacity constraints. 100 packet threshold with 5 consecutive periods balances sensitivity with false positive prevention. Requires immediate capacity scaling."
NAT GW,ActiveConnectionCount,ActiveConnectionCount,Maximum,"> 44,000 connections",60,3,2,P2-High,Leading indicator for port allocation errors. 44k = 80% of 55k connection limit provides advance warning before ErrorPortAllocation triggers. Maximum statistic ensures worst-case connection count detected. 2/3 datapoints allows for brief connection spikes while alerting on sustained high usage.
NAT GW,ConnectionAttemptCount,ConnectionAttemptCount,Sum,Anomaly Detection,300,3,2,P2-High,"Anomaly detection for new connection attempts identifies unusual traffic patterns. Sudden spikes may indicate port scanning, DDoS attempts, or application misconfiguration (connection leak, missing pooling). Sudden drops indicate service degradation or upstream failures."
NAT GW,BytesOutToDestination,BytesOutToDestination,Anomaly Detection,GreaterThanUpperThreshold,300,3,2,P3-Medium,"Outbound traffic anomaly detection for capacity planning and cost monitoring. NAT Gateway charged per GB processed. Unusual spikes identify runaway processes, data exfiltration, or misconfigured applications. Helps predict monthly costs and identify optimization opportunities."
