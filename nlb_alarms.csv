Component,Alarm Name,Metric Name,Statistic,Threshold,Period (seconds),Evaluation Periods,Datapoints to Alarm,Severity,Reasoning
NLB,UnHealthyHostCount,UnHealthyHostCount,Maximum,>= 1,60,3,2,P1-Critical,Maximum statistic captures worst-case scenario across all NLB nodes. Any unhealthy target means degraded capacity. 2/3 datapoints prevents false positives from transient health check failures while detecting persistent issues within 3 minutes.
NLB,HealthyHostCount,HealthyHostCount,Minimum,< 3 (adjust based on min capacity),60,3,2,P1-Critical,"Minimum statistic ensures ANY NLB node seeing insufficient capacity triggers alarm. Threshold should match minimum required healthy targets for service redundancy (e.g., 3 for HA). Prevents complete service failure."
NLB,PortAllocationErrorCount,PortAllocationErrorCount,Sum,>= 10,60,5,5,P1-Critical,"Non-zero values indicate dropped connections due to ephemeral port exhaustion (55k connection limit per target). Threshold of 10 provides early warning. All 5 periods ensure persistent issue, not transient spike. Production-validated threshold."
NLB,TCP_Target_Reset_Count,TCP_Target_Reset_Count,Anomaly Detection,LessThanLowerThreshold (8 std dev),300,3,2,P2-High,Anomaly detection adapts to variable application behavior. Lower threshold detects unexpected drops in resets (service issues). 8 std dev reduces sensitivity to prevent false positives. 5-minute period smooths out momentary fluctuations.
NLB,ClientTLSNegotiationErrorCount,ClientTLSNegotiationErrorCount,Sum,> 50,300,2,2,P2-High,"TLS handshake failures with clients indicate certificate expiration, cipher mismatches, or TLS version incompatibilities. Threshold of 50 per 5 minutes ~0.5-1% error rate for typical traffic. 2 consecutive periods confirms sustained issue."
NLB,TargetTLSNegotiationErrorCount,TargetTLSNegotiationErrorCount,Sum,> 50,300,2,2,P2-High,"TLS failures between NLB and targets indicate backend certificate issues, expired certs, or target SSL configuration problems. Same threshold reasoning as client TLS errors. Critical for end-to-end encryption validation."
NLB,TCP_Client_Reset_Count,TCP_Client_Reset_Count,Sum,> 100,300,2,2,P2-High,"RST packets from clients may indicate client-side issues, application timeouts, or network problems. Higher threshold (100) than target resets as client-side resets less actionable. Informational for traffic pattern analysis."
NLB,ActiveFlowCount,ActiveFlowCount,Maximum,> 80% of expected capacity,300,2,2,P3-Medium,Monitors connection volume for capacity planning. 80% threshold provides buffer before hitting limits. Helps predict when to scale target count or upgrade target instance types. Proactive capacity management.
NLB,ProcessedBytes,ProcessedBytes,Anomaly Detection,GreaterThanUpperThreshold,300,3,2,P3-Medium,"Anomaly detection for throughput identifies unusual traffic patterns - potential DDoS, sudden traffic drops (outage), or unexpected traffic spikes. Upper threshold alerts on abnormal increases requiring capacity review."
